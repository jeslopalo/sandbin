#!/usr/bin/env sandbash

to_dir=
force=0

function usage() {
	printf "${YELLOW}%s${NORMAL}\n" "usage: git-setup-attributes [--to-dir] [-F | --force] [-h | --help]"
}

while [[ $# > 0 ]];  do
    key="$1"

    case $key in
        --to-dir)
        to_dir="$2"
        shift
        ;;
        -F|--force)
        force=1
        ;;
        -h|--help)
        usage
        exit 1
        ;;
    esac
    shift
done

set -e

if [ ! -z "$to_dir" ]; then
    target_file=$to_dir/.gitattributes
else
    target_file=.gitattributes
fi

if [ ! -f "$target_file" ] || [ "$force" -eq 1 ] ; then
    printf "${GREEN}Creating .gitattributes file ['%s']${NORMAL}\n" "$target_file"
    cp "$SANDBIN_HOME/dotfiles/gitattributes/default.gitattributes" "$target_file"
else
    printf "The file ${RED}'%s'${NORMAL} already exists!\n" "$target_file"
fi

exit 1