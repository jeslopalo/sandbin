#compdef gitbox

_gitbox() {

    local curcontext="$curcontext" state line
    typeset -A opt_args

    _arguments -C \
        ':command:->command' \
        '*::options:->options'

    case $state in
        (command)
            local -a subcommands;

            subcommands=(
                'init:Execute \"git init\" & \"git flow init\"'
                'setup:Several git configurations'
                '-h:display gitbox usage instructions'
                '--help:display gitbox usage instructions'
            )
            _describe -t commands 'gitbox' subcommands
        ;;

        (options)
			case $line[1] in

				(init)
				    __gitbox-init
				;;

				(setup)
				    __gitbox-setup
                ;;
			esac
		;;
    esac
}

__gitbox-init() {
    _arguments \
        -f'[Force setting of gitflow branches, even if already configured]' \
        -h'[Show help for gitbox init command]' \
        --help'[Show help for gitbox init command]'
}

__gitbox-setup() {

    local curcontext="$curcontext" state line
    typeset -A opt_args

    _arguments -C \
        ':command:->command' \
        '*::options:->options'

    case $state in
        (command)
            local -a subcommands;

            subcommands=(
                'user:Configure repository user.name'
            )
            _describe -t commands 'gitbox setup' subcommands
        ;;

		(options)
			case $line[1] in

                (user)
                    __gitbox-setup-user
                ;;
			esac
		;;
    esac
}

__gitbox-setup-user() {

    local curcontext="$curcontext" state line
    typeset -A opt_args

    _arguments -C \
        ':command:->command' \
        '*::options:->options'

    case $state in
        (command)
            local -a subcommands;

            subcommands=(
                '--system:Use system config file'
                '--global:Use global config file'
                '--local:Use repository config file'
            )
            _describe -t commands 'gitbox setup user' subcommands
        ;;

		(options)
			case $line[1] in

                (--system)
                ;;
                (--global)
                ;;
                (--local)
                ;;

			esac
		;;
    esac
}

# I don't know what is this
#compdef _gnu_generic gitbox

#_gitbox "$@"
zstyle ':completion:*:*:git:*' user-commands gitbox:'provide high-level repository operations'