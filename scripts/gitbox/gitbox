#!/usr/bin/env sandbash

source "${SANDBIN_HOME}/scripts/lib/colors.lib.zsh"
source "${SANDBIN_HOME}/scripts/lib/git-functions.lib.zsh"

source "${SANDBIN_HOME}/scripts/gitbox/lib/gitbox.lib.zsh"
source "${SANDBIN_HOME}/scripts/gitbox/lib/gitbox.init.zsh"
source "${SANDBIN_HOME}/scripts/gitbox/lib/gitbox.setup.zsh"
source "${SANDBIN_HOME}/scripts/gitbox/lib/gitbox.ranking.zsh"
source "${SANDBIN_HOME}/scripts/gitbox/lib/gitbox.changelog.zsh"

function usage() {
    printf "It provides several utilities for working with git\n"
    printf "${YELLOW}%s${NORMAL}\n" "usage: gitbox [init [-f]] [setup] [changelog] [-h | --help]"
}

function gitbox() {

    if [ $# = 0 ]; then
        printf "${RED}Sorry! I need a gitbox subcommand to continue :(${NORMAL}\n"
        usage;
        exit 1;
    fi

    while [[ $# > 0 ]];  do
        key="$1"

        case $key in
            init)
                shift
                gitbox-init "$@"
                exit $?
            ;;
            setup)
                shift
                gitbox-setup "$@"
                exit $?
            ;;
            changelog)
                shift
                gitbox-changelog "$@"
                exit $?
            ;;
            ranking)
                shift
                gitbox-ranking "$@"
                exit $?
            ;;
            -h|--help)
                usage
                exit 0
            ;;
            *)
                printf "${RED}Ouch! Unknown option '%s'. Please try agan!${NORMAL}\n" "$key"
                usage
                exit 1
            ;;
        esac

        shift;
    done
}

gitbox "$@"